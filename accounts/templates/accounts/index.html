{% extends 'base.html' %} {% load static %} {% block title %}Dashboard | Dummy Inc. {%endblock title %}


{% block content %}

<div class="container-fluid px-4">
  
  <div class="d-flex justify-content-between small">
      <div><h5 class="mt-4">{{ range }} Stats:</h5><br></div>
      <div class="form-group mt-4">
        <form id="dataperiodform" name="periodform" action="" method="POST" onchange="dataperiodform.submit();">
          {% csrf_token %}
          {% comment %} <label for="dataperiod"><h6>Period:</h6></label> {% endcomment %}
          <select id="dataperiod" name="dataperiod">
            <option value="">Select Period</option>
            <option value="all_time">All Time</option>
            <option value="today">Today</option>
            <option value="last_7_days">Last 7 Days</option>
            <option value="last_30_days">Last 30 Days</option>
            <option value="last_60_days">Last 60 Days</option>
            <option value="last_90_days">Last 90 Days</option>
            <option value="current_month">Current Month</option>
            <option value="current_year">Current Year</option>
          </select>
        </form>
        <br>
      </div>
  </div>

 

  <div class="row">
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
          <h4 class="text-center text-dark-grey">{{ customers_count }}</h4>
          <h6 class="text-center text-theme">Total Customers</h6>
        </div>
      </div>
    </div>
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h4 class="text-center text-dark-grey">{{ orders_count }}</h4>
            <h6 class="text-center text-theme">Total Orders</h6>
        </div>
      </div>
    </div>
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h4 class="text-center text-dark-grey">${{ orders_sum |floatformat:2 }}</h4>
            <h6 class="text-center text-theme">Total Revenue</h6>
        </div>
      </div>
    </div>
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h4 class="text-center text-dark-grey">${{ average_order_value |floatformat:2 }}</h4>
            <h6 class="text-center text-theme">Average Order Value</h6>
        </div>
      </div>
    </div>
</div>
  



<div class="row">
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card bg-white text-dark mb-4">
      <div class="card-body">
          <h4 class="text-center text-dark-grey">${{ orders_expenses |floatformat:2 }}</h4>
          <h6 class="text-center text-theme">Order Expenses</h6>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card bg-white text-dark mb-4">
      <div class="card-body">
          <h4 class="text-center text-dark-grey">${{ gross_profit |floatformat:2 }} <span class="badge bg-dark text-white font-weight-medium badge-pill small-text"> ({{ gross_profit_percentage |floatformat:2 }}%) </span></h4>
          <h6 class="text-center text-theme">Gross Profit</h6>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card bg-white text-dark mb-4">
      <div class="card-body">
          <h4 class="text-center text-dark-grey">${{ other_expenses |floatformat:2 }}</h4>
          <h6 class="text-center text-theme">General Expenses</h6>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card bg-white text-dark mb-4">
      <div class="card-body">
          <h4 class="text-center text-dark-grey">${{ net_profit |floatformat:2 }} <span class="badge bg-dark text-white font-weight-medium badge-pill small-text">({{ net_profit_percentage |floatformat:2 }}%) </span></h4>
          <h6 class="text-center text-theme">Net Profit</h6>
      </div>
    </div>
  </div>
</div>

<div class="row">
    <div class="col-xl-6">
        <div class="card mb-4">
            {% comment %} <div class="card-header bg-dark text-white">
                <i class="fas fa-user-tie me-1"></i>
                Top 5 Customers
            </div> {% endcomment %}
            <div class="card-body">
                <h5>{{ range }} Top 5 Customers:</h5>
                <canvas id="customerChart" width="100%">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
                <script>
                  var ctx = document.getElementById("customerChart");
                  var customerChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                      labels: {{ customer_labels|safe }},
                      datasets: [{
                        label: 'Customers',
                        data: {{ customer_data|safe }},
                        backgroundColor: ['#C80000', '#630094', '#F7D801', '#0D761E', '#00279C'],
                      }],
                    },
                  });
                </script>
                </canvas>
                <table class="mt-20 table table-bordered table-hover">
                    <thead class="bg-light-grey text-dark">
                    <tr>
                        <th>Name</th>
                        <th>City</th>
                        <th>Orders</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    {% comment %} {% for customer in customers_top_five %} {% endcomment %}
                    {% for customer in customers_top_five %}
                    <tr>
                        <td>{{ customer.customer }}</td>
                        <td>{{ customer.customer_city }}</td>
                        <td>{{ customer.orders_count }}</td>
                        <td>${{ customer.orders_sum | floatformat:2 }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
    <div class="col-xl-6">
        <div class="card mb-4">
            {% comment %} <div class="card-header bg-dark text-white">
                <i class="fas fa-globe me-1"></i>
                Top 5 Cities
            </div> {% endcomment %}
            <div class="card-body">
                <h5>{{ range }} Top 5 Cities:</h5>
                <canvas id="cityChart" width="100%">
                <script>
                  var ctx = document.getElementById("cityChart");
                  var cityChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                      labels: {{ city_labels|safe }},
                      datasets: [{
                        data: {{ city_data|safe }},
                        backgroundColor: ['#1E71F6', '#E61177', '#3CD014', '#AC0EB6', '#F75620'],
                      }],
                    },
                  });
                </script>
                </canvas>
                <table class="mt-20 table table-hover table-bordered">
                    <thead class="bg-light-grey text-dark">
                    <tr>
                        <th>City</th>
                        <th>Orders</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    {% for city in cities_top_five %}
                    <tr>
                        <td>{{ city.customer_city }}</td>
                        <td>{{ city.ord_count }}</td>
                        <td>${{ city.ord_sum | floatformat:2 }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-xl-6">
        <div class="card mb-4">
            {% comment %} <div class="card-header bg-dark text-white">
                <i class="fas fa-truck me-1"></i>
                Delivery Status
            </div> {% endcomment %}
            <div class="card-body">
                <h5>{{ range }} Delivery Status:</h5>
                <canvas id="deliveryChart" width="100%">
                <script>
                  var ctx = document.getElementById("deliveryChart");
                  var deliveryChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                      labels: {{ delivery_labels|safe }},
                      datasets: [{
                        data: {{ delivery_data|safe }},
                        backgroundColor: ['#F40000', '#7C007C', '#185B49', '#870E38', '#F7E100', '#010BE4', '#FF6100', '#C73EF7', '#DE139E', '#00B526', ],
                      }],
                    },
                  });
                </script>
                </canvas>
                <table class="mt-20 table table-hover table-bordered">
                    <thead class="bg-light-grey text-dark">
                    <tr>
                        <th>Delivery Status</th>
                        <th>Orders Count</th>
                        <th>Amount</th>
                    </tr>
                    </thead>
                    {% for status in deliveries_status %}
                    <tr>
                        <td>{{ status.delivery_status }}</td>
                        <td>{{ status.del_stat_count }}</td>
                        <td>${{ status.del_stat_sum |floatformat:2 }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
    <div class="col-xl-6">
        <div class="card mb-4">
            {% comment %} <div class="card-header bg-dark text-white">
                <i class="fas fa-money-bill-alt me-1"></i>
                Payment Status
            </div> {% endcomment %}
            <div class="card-body">
                <h5>{{ range }} Payment Status:</h5>
                <canvas id="paymentChart" width="100%">
                <script>
                  var ctx = document.getElementById("paymentChart");
                  var paymentChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                      labels: {{ payment_labels|safe }},
                      datasets: [{
                        data: {{ payment_data|safe }},
                        backgroundColor: ['#0A48DB', '#CC1C88', '#FCD300', '#93BF42', '#E9481C', '#A602AD', '#3A56F7', '#D11802', '#00A800', '#9A05BF', ],
                      }],
                    },
                  });
                </script>
                </canvas>
                <table class="mt-20 table table-hover table-bordered">
                <thead class="bg-light-grey text-dark">
                <tr>
                    <th>Payment Status</th>
                    <th>Orders Count</th>
                    <th>Amount</th>
                </tr>
                </thead>
                {% for status in payments_status %}
                <tr>
                    <td>{{ status.payment_status }}</td>
                    <td>{{ status.pay_stat_count }}</td>
                    <td>${{ status.pay_stat_sum |floatformat:2 }}</td>
                </tr>
                {% endfor %}
            </table>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

