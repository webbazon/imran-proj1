{% extends 'base.html' %}
{% load static %} 

{% block title %} {{ vendor.vendor }} (Vendor) | Dummy Inc. {% endblock title %} 

{% block content %}

<div class="container-fluid px-4">
    <h5 class="mt-4 text-theme">Vendor Ref# {{ vendor.vendor_id }} Details</h5><br>
  <div class="row">
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
          <h4 class="text-center text-dark-grey">{{ vendor.vendor }}</h4>
          <h6 class="text-center text-theme">Vendor Name</h6>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h4 class="text-center text-dark-grey">{{ vendor.vendor_address }}</h4>
            <h6 class="text-center text-theme">Vendor Address</h6>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h4 class="text-center text-dark-grey">{{ vendor.vendor_city }}</h4>
            <h6 class="text-center text-theme">Vendor City</h6>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <a href="{% url 'vendors-edit' vendor.vendor_id %}"><h6 class="btn btn-single bg-dark text-white">Edit Vendor</h6></a>
            <a href="{% url 'vendors-delete' vendor.vendor_id %}"><h6 class="btn btn-single bg-danger text-white">Delete Vendors</h6></a>
        </div>
      </div>
    </div>
</div>


<div class="row">
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
          <h5 class="text-center text-dark-grey">{{ vendor.contact_person }}</h5>
          <h6 class="text-center text-theme">Contact Person</h6>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h5 class="text-center text-dark-grey">{{ vendor.designation }}</h5>
            <h6 class="text-center text-theme">Designation</h6>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h5 class="text-center text-dark-grey">{{ vendor.email }}</h5>
            <h6 class="text-center text-theme">Email ID</h6>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6">
      <div class="card bg-white text-dark mb-4">
        <div class="card-body">
            <h5 class="text-center text-dark-grey">{{ vendor.phone }}</h5>
            <h6 class="text-center text-theme">Phone/ Mobile</h6>
        </div>
      </div>
    </div>
</div>


<div class="row">
    <div class="col-xl-6">
        <div class="card mb-4">
            <div class="card-body">
                <h5>Financial Summary</h5>
                <table class="mt-20 table table-bordered table-hover">
                    <thead class="bg-light-grey text-dark">
                    <tr>
                        <th>Purchases</th>
                        <th>Value</th>
                        <th>Avg. Purchase Value</th>
                        <th>Share in Total Purchases</th>
                    </tr>
                    </thead>
                    <tr>
                        <td>{{ purchase_count }}</td>
                        <td>${{ purchase_sum |floatformat:2 }}</td>
                        <td>${{ average_purchase_value |floatformat:2 }}</td>
                        <td>{{ percentage_share |floatformat:2 }} %</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <div class="col-xl-6">
        <div class="card mb-4">
            <div class="card-body">
                <h5>Orders History</h5>
                <table class="mt-20 table table-hover table-bordered">
                    <thead class="bg-light-grey text-dark">
                    <tr>
                        <th>First Purchase</th>
                        <th>Last Purchase</th>
                        <th>Time Since Last Purchase</th>
                    </tr>
                    </thead>
                    <tr>
                        <td>{{ vendor_purchase.first }}</td>
                        <td>{{ vendor_purchase.last }}</td>
                        <td>{{ vendor_purchase.last|timesince }}</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>


<div class="card mb-4">
    <div class="card-body">
        <h5>Purchases from {{ vendor.vendor }}, {{ vendor.vendor_city }}:</h5>
        <div class="table-responsive-md">
          <table id="infoTable" class="display table table-bordered table-hover">
              <thead class="bg-dark text-white">
                  <tr>
                      <th>Date</th>
                      <th>ID</th>
                      <th>Value</th>
                      <th>Details</th>
                      <th>Payment Mode</th>
                      <th>Paid By</th>
                      <th>View</th>
                  </tr>
              </thead>
              {% for purchase in purchases %}
                <tr>
                    <td>{{ purchase.expense_date }}</td>
                    <td>{{ purchase.order_ref }}</td>
                    <td>${{ purchase.expense_amount | floatformat:2}}</td>
                    <td>{{ purchase.description }}</td>
                    <td>{{ purchase.expense_mode }}</td>
                    <td>{{ purchase.expense_made_by }}</td>
                    <td><a href="{% url 'order' purchase.order_ref %}"><i class="fas fa-eye icon-view"></a></td>
                </tr>
            {% endfor %}
          </table>
        </div>
    </div>
</div>


{% endblock content %}